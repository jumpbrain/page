<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/page/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=page/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Data Scientist at War: Part 2 | Jumpbrain</title>
<meta name="keywords" content="Useful thought model, Bayes">
<meta name="description" content="Structured, bidirectional information flow">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/page/posts/bayes/">
<link crossorigin="anonymous" href="http://localhost:1313/page/assets/css/stylesheet.0b79fb5bab11994e675e84cee1f419f248d0096c0dfc01dcd0d378b39ff40899.css" integrity="sha256-C3n7W6sRmU5nXoTO4fQZ8kjQCWwN/AHc0NN4s5/0CJk=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/page/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/page/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/page/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/page/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/page/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/page/posts/bayes/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

>
<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/page/" accesskey="h" title="Jumpbrain (Alt + H)">Jumpbrain</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Jumpbrain">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/beauty-contest/" title="Beauty Contest">
                    <span>Beauty Contest</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Data Scientist at War: Part 2
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-description">
      Structured, bidirectional information flow
    </div>
    <div class="post-meta"><span title='2025-08-26 17:12:11 +0200 CEST'>August 26, 2025</span>&nbsp;·&nbsp;10 min

</div>
  </header> 
  <div class="post-content"><blockquote>
<p>It&rsquo;s not about the tools, it&rsquo;s how you apply them. In data science, it&rsquo;s not about the model&hellip;</p></blockquote>
<p>I call all models &rsquo;thought models&rsquo; for a reason. It should ideally force you to confront YOUR known facts, YOUR priors and YOUR assumptions about them explicitly. It&rsquo;s not about the model, it&rsquo;s about your thinking about the model.</p>
<p>That&rsquo;s why I&rsquo;m drawn to statistical models and algos in general. Beyond trivial notation, beneath the practical aspects, you find very clever best-practices that instantly elevate your reasoning. Consider this&hellip;</p>
<h3 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h3>
<p>You&rsquo;re a forward deployed analyst in a country called Extremiststan. The FOB at which you sit is located a few miles south of the main city, Dystopolis. Tonight, some of your colleagues are going to meet with a prospective source. There are three roads leading into Dystopolis, the horizontal road, the vertical road and the diagonal road. They need your call on which route to take.</p>
<p>You scrape incident reports via some social media channels that you&rsquo;re currently tracking as well as police reports sourced from the local department. You aggregate the last year of data for each road.</p>
<p>The vertical road has seen a spike in incidents over the last two weeks, then it cleared up. In the last 72 hours exactly zero incidents have been reported on that road.</p>
<p>Perfect! You run a quick forecast, the vertical road has the lowest probability of incidents over the next 12 hours. You recommend it. They move out.</p>
<p>A few moments later, you find that:</p>
<p>The vertical road has been red listed by local police. They no longer respond there. A local news station has been trying to send crews there but the reporters won&rsquo;t go. A reporter from a competing local news agency recently responded to a tweet (X) that he wouldn&rsquo;t set foot there no matter what. Your collegaues left 2 hours ago&hellip;</p>
<blockquote>
<p>Sh*t!</p></blockquote>
<p>Similar examples show up in cyber incidents, medical risk, the list goes on&hellip; You don&rsquo;t need a Masters in statistics to see the problem. No exposure, no patrols, no reporters, no logs, can make a very dangerous road look favourable.</p>
<p>When thinking about count data, e.g number of incidents on a road over time, try and think of the counts as manifestations from an underlying (latent) risk surface, that you cannot directly observe.</p>
<p>Then, you model that surface&hellip;</p>
<h3 id="method">Method<a hidden class="anchor" aria-hidden="true" href="#method">#</a></h3>
<p>We briefly go over the simulated data, read scenario, and cover a hierarchical approach.</p>
<h3 id="data">Data<a hidden class="anchor" aria-hidden="true" href="#data">#</a></h3>
<p>The Extremiststan situation is simplistic. Each day, each segment of each road either sees some incidents or not. A road segment on a given day will produce 1 row in our data. We observe number of incidents on that segment and day. We note down which of the three roads. We use segment ID&rsquo;s along the roads, an index for the day, coordinates for plotting and a proxy for how much opportunity there was for something bad to happen, called exposure.</p>
<p>You can think of exposure as, number of vehicles using that segment, patrol presence or how much of that road was observable and reportable.</p>
<p>We call the observed incident count on segment–day $i$ by $y_i$. For that observation we have corresponding exposure $exp_i$, $road[i]$ and $day[i]$.</p>
<h2 id="model">Model<a hidden class="anchor" aria-hidden="true" href="#model">#</a></h2>
<p>The reason why you use a hierarchy is that it allows a controlled way for information to flow.</p>
<p>[image]</p>
<p>The $\alpha$ and hyperparameters $\simga_{road}$ and $\sigma_{day}$ sit at the top of the hierarchy. They summarize overall activity and heterogeneity between different roads and different days. Think of it like <strong>regional information</strong> trickling down to your risk estimates for individual roads. Underneath that you have the road-level deviations. $u_r carries tendencies of each road and the day-level deviations over time. $v_d$ carries system wide swings over time. At the bottom we have the segment-day means $\mu_i$.</p>
<p>When you observe a count $y_i$ on one segment, at one time, you&rsquo;re nudging the segment, its road, its day, and through them the global/overarching picture.</p>
<blockquote>
<p>Information flow upwards.</p></blockquote>
<p>That updated global/overarching picture feeds back into all other segments, especially where there is little direct data.</p>
<blockquote>
<p>Information flow downwards.</p></blockquote>
<p>That is the point of a hierarchical approach, structured, bi-directional information flow between local/ground and global/overarching levels of information.</p>
<p>For this toy example we start with a simple Poisson model for count data (maths can induce panic, try skimming through this part anyway, you might surprise yourself, it&rsquo;s <strong>easier</strong> than it looks at first glance):</p>
<p>$y_i \sim Poisson(\mu_i)$</p>
<p>Here $\mu_i$ represents the expected number of incidents on that segment-day. We could define it as a rate,</p>
<p>$$\lambda_i = \frac{\mu_i}{exp_i}$$</p>
<p>But for cleanliness we prefer the log-scale and treat exposure as a covariate:</p>
<p>$$log \mu_i = \alpha + u_{road[i]}+ v_{day[i]} + \beta_{exp} \cdot zlogexp_i$$</p>
<p>where $zlogexp_i$ is the standardized log(exp_i).</p>
<p>$\alpha$ is a global baseline log-rate, think of it as regional assessments. If all deviations were zero, it&rsquo;s the log <strong>expected</strong> incident count at typical exposure for the region. The $u_{road}$ terms are road specific deviations around that baseline. The $v_{day}$ terms are day-specific deviations that capture the overall swings over time. $\beta_{exp}$ describes how strongly the expected count scales with exposure once we have already accounted for road and day.</p>
<p>The hierarchical part comes from how we treat those road and day effects. Instead of giving each road its own unrelated parameter, we assume that roads are similar but not identical draws from a common distribution (keep reading). Formally,</p>
<p>$$u_r \sim N(0, \sigma_{road})$$ for $r \in 1, &hellip;, R$.</p>
<p>$$v_d \sim N(0, \sigma_day)$$ for $d \in 1, &hellip;, D$.</p>
<p>To maintain $\alpha$ as the global average log-rate and the road/day terms as deviations, rather than duplicate intercepts we typically place constraints by,</p>
<p>$\sum_{r=1}^R v_r = 0$ and $\sum_{d=1}^D v_d = 0$</p>
<p>The hyperparameters $\sigma_{road}$ and $\sigma_{day}$ control how tightly roads and days are coupled to the global mean. With small $\sigma_{road}$ the models believes the roads behave similarily, their effects are pulled toward zero unless the data clearly states something different. With large $\simga_{road}$ the model is willing to let roads drift far away from each other. We use a weakly informed prior for them,</p>
<p>$$\simga_{road} \sim N^+(0.5)$$</p>
<p>$$\sigma_{day} \sim N^+(0.2)$$</p>
<p>Basically, differences exist, but the default is modest differences unless the data shows big gaps.</p>
<p>The global baseline gets a weakly informative prior in a plausible range for rare incidents,</p>
<p>$$\alpha \sim N(-4, 1)$$</p>
<p>The exposure coefficient is allowed to move but gently shrunk toward zero,</p>
<p>$$\beta_{exp} \sim N(0, 0.5)$$</p>
<p>We then fit this model with Hamiltonian Monte Carlo in PyMC.</p>
<h3 id="results">Results<a hidden class="anchor" aria-hidden="true" href="#results">#</a></h3>
<p>Posting this again for clarity:</p>
<p>$$log \mu_i = \alpha + u_{road[i]}+ v_{day[i]} + \beta_{exp} \cdot zlogexp_i$$</p>
<p>Now, return to the vertical road. For two weeks it was active, several incidents distributed over segments and days, with decent exposure. Those data have already pushed its road effect up relative to the other roads in the area. They have also told the model something about the variability for all roads: roads are not identical; at least one of them behaves worse than the grand mean.</p>
<p>Next, exposure on that road collapses. Patrols avoid it, civilians detour, media shy away. What you see in the feed is a string of zeros.</p>
<p>In a non-hierarchical, the one you used in the intro, those zeros can be treated in isolation from the other roads. Additionally, the most recent days heavily dominate your estimate of the current risk rate on that road. In that world, one could assume that the vertical road has calmed down, since there is nothing in the structure that remembers, or cares, that this road was systematically bad before everyone stopped going there or that the region overall has gotten worse.</p>
<p>In the hierarchical model, the same zeros mean something different. They are interpreted against a backdrop of an already elevated incident count on the vertical road, a known exposure pattern, and what the other roads are doing <strong>all the way to the regional level and over time</strong>.</p>
<p>The information flow is asymmetric. A quiet, heavily travelled road will aggressively pull its road effect down. The model reads that as genuine indications of lower risk: Lots of opportunities, nothing happened. A quiet, abandoned road over a short period barely moves the needle; the prior belief encoded in
the road effect resists overreaction.</p>
<p>Even across roads. If you have one very bad road and two very quiet roads, the posterior for road variability has to stretch to accommodate that spread. With more quiet roads, the vertical road has to work harder, data wise, to claim that it is fundamentally different rather than just unlucky. Suppose the diagonal road has been consistently quiet, with good exposure, lots of traffic. All road effects share a deviation term and are tied to the same overarching information about how calm, a calm road can be. This should affect how extreme you are willing to believe the vertical road is.</p>
<p>Pooling over time behaves similarly. If there is a week where all roads spike, the day effects capture that as a shared elevation in risk over time. When the spike ends, the estimates go back down, but they don&rsquo;t instantly forget that the system had a bad week. On top of that, the individual road effects capture that even on bad weeks, some roads are worse than others, and segment–day means combine the two.</p>
<p>Out of this machinery you can extract, whatever summary, a map colored by latent risk rather than a count map. Aggregating over time gives you road-level risk estimates that already contain pooling across days and segments. You can even compute probabilities of one route being safer than another, and use that as a more honest input to a discussion than recent counts.</p>
<p>Is this truth? Of course not. If exposure is mis-measured, if reporting is suppressed, if one road is governed by a genuinely different process you will still be wrong. The difference is that now the wrongness is traceable: you can point directly at terms, road variability, time variable patterns and say;</p>
<blockquote>
<p>This is where I expressed my beliefs. This is where I went wrong. This is how I&rsquo;ll adapt.</p></blockquote>
<h3 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h3>
<p>A hierarchical model is a useful thought tool. It forces you to say, on the record, how you think information should flow between the big picture and the local one.</p>
<blockquote>
<p>Keyword is: Humility.</p></blockquote>
<p>In Extremiststan, the benefit of a small Bayesian hierarchical Poisson model has nothing to do with fancy computation. It is about how information is allowed to flow. The global mean and hyperparameters carry a rough, system-wide (regional) picture. The road-level terms carry persistent, route-specific tendencies but borrow information from one another. The day-level terms carry swings over time. Segment–day risks sit at the bottom of this stack and are shaped by all of the above.</p>
<p>Counts still matter. Zeros still matter. A zero with high exposure on an ordinarily safe road is strong evidence of safety. The same zero with low exposure on a historically dangerous, partially abandoned road is not. The hierarchy encodes that difference.</p>
<p>As with our power-weighted prediction exercise for the Russo–Ukrainian war, [link to post], the final warning is the same. These estimates are not data; they are your assumptions, pushed through a model and returned to you in numeric form. If you are biased about which roads are similar or how exposure works, the output will mirror that bias.</p>
<h3 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h3>
<p>Gelman, A., Hill, J., &amp; Vehtari, A. (2020). Regression and Other Stories. Cambridge University Press.</p>
<p>McElreath, R. (2020). Statistical Rethinking: A Bayesian Course with Examples in R and Stan (2nd ed.). CRC Press.</p>
<p>PyMC Development Team. PyMC: Bayesian Modeling and Probabilistic Programming in Python.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/page/tags/useful-thought-model/">Useful Thought Model</a></li>
      <li><a href="http://localhost:1313/page/tags/bayes/">Bayes</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/page/">Jumpbrain</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
